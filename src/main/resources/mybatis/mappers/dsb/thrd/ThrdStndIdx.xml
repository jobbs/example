<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ncis.sql.dsb.thrd.thrdStndIdx">



	<select id="selectThrdStndIdxList" parameterType="ncis.dsb.thrd.thrdConf.vo.ThrdStndIdxSearchVo" resultType="ncis.dsb.thrd.thrdConf.vo.ThrdStndIdxVo">
		/* ncis.sql.dsb.thrd.thrdStndIdx.selectThrdStndIdxList */
		<include refid="ncis.cmn.queryForPagingHeader" />
			SELECT 	A.PROF_ID
				, A.PROF_NM
				, A.DC
				, MAX(CASE WHEN B.IDX_ITM_ID='0' THEN THRES_DFLT_CONT_CNT END) SERVER_STAT_CONT_CNT
				, MAX(CASE WHEN B.IDX_ITM_ID='0' THEN CMPR_STDR END) SERVER_STAT_CMPR_STDR

				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='02' THEN DFLT_THRES_VL END)  CRITICAL_CPU_USE_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='02' THEN CMPR_STDR END)  CRITICAL_CPU_USE_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='02' THEN THRES_DFLT_CONT_CNT END)  CRITICAL_CPU_USE_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='03' THEN DFLT_THRES_VL END)  MAJOR_CPU_USE_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='03' THEN CMPR_STDR END ) MAJOR_CPU_USE_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='11' AND THRES_GRD_ID='03' THEN THRES_DFLT_CONT_CNT END ) MAJOR_CPU_USE_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='02' THEN DFLT_THRES_VL END)  CRITICAL_CPU_VRLZ_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='02' THEN CMPR_STDR END)  CRITICAL_CPU_VRLZ_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='02' THEN THRES_DFLT_CONT_CNT END)  CRITICAL_CPU_VRLZ_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='03' THEN DFLT_THRES_VL END)  MAJOR_CPU_VRLZ_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='03' THEN CMPR_STDR END)  MAJOR_CPU_VRLZ_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='12' AND THRES_GRD_ID='03' THEN THRES_DFLT_CONT_CNT END)  MAJOR_CPU_VRLZ_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='02' THEN DFLT_THRES_VL END)  CRITICAL_MEM_USE_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='02' THEN CMPR_STDR END)  CRITICAL_MEM_USE_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='02' THEN THRES_DFLT_CONT_CNT END)  CRITICAL_MEM_USE_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='03' THEN DFLT_THRES_VL END)  MAJOR_MEM_USE_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='03' THEN CMPR_STDR END)  MAJOR_MEM_USE_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='21' AND THRES_GRD_ID='03' THEN THRES_DFLT_CONT_CNT END)  MAJOR_MEM_USE_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='02' THEN DFLT_THRES_VL END)  CRITICAL_MEM_VRLZ_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='02' THEN CMPR_STDR END)  CRITICAL_MEM_VRLZ_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='02' THEN THRES_DFLT_CONT_CNT END)  CRITICAL_MEM_VRLZ_RT_CONT_CNT

				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='03' THEN DFLT_THRES_VL END)  MAJOR_MEM_VRLZ_RT_VL
				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='03' THEN CMPR_STDR END)  MAJOR_MEM_VRLZ_RT_CMPR_STDR
				, MAX(CASE WHEN B.IDX_ITM_ID='22' AND THRES_GRD_ID='03' THEN THRES_DFLT_CONT_CNT END)  MAJOR_MEM_VRLZ_RT_CONT_CNT
			FROM ST_PROF A, ST_THRES_dFLT_CONF B
			WHERE A.PROF_ID = B.PROF_ID
			<if test='profNm!=null and !"".equals(profNm)'>
				AND A.PROF_NM LIKE '%'|| #{profNm} || '%'
			</if>
			<if test='dc!=null and !"".equals(dc)'>
				AND A.DC  LIKE '%'|| #{dc} || '%'
			</if>
			<if test='profId!=null '>
				AND A.PROF_ID = #{profId}
			</if>
			GROUP BY A.PROF_ID
				, A.PROF_NM
				, A.DC
			ORDER BY A.PROF_ID
		<include refid="ncis.cmn.queryForPagingFooter" />
	</select>
	<select id="selectThrdStndIdxTotCnt" parameterType="ncis.dsb.thrd.thrdConf.vo.ThrdStndIdxSearchVo" resultType="int">
		/* ncis.sql.dsb.thrd.thrdStndIdx.selectThrdStndIdxTotCnt */
			SELECT 	COUNT(DISTINCT A.PROF_ID)
			FROM ST_PROF A, ST_THRES_dFLT_CONF B
			WHERE A.PROF_ID = B.PROF_ID
			<if test='profNm!=null and !"".equals(profNm)'>
				AND A.PROF_NM LIKE '%'|| #{profNm} || '%'
			</if>
			<if test='dc!=null and !"".equals(dc)'>
				AND A.DC  LIKE '%'|| #{dc} || '%'
			</if>
			<if test='profId!=null '>
				AND A.PROF_ID = #{profId}
			</if>
	</select>



</mapper>